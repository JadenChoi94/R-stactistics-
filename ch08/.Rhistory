hist(a.2.mean, prob=T, ylab="", xlab="", main="표본 크기 : 2",
col="orange", border="red")
x1<-seq(min(a.2.mean), max(a.2.mean), length=1000)
y1<-dnorm(x=x1, mean=3, sd(2/sqrt(2)))
lines(x1, y1, lty=2, lwd=2, col='blue')
sqrt(128)
c(mean(a.2.mean), sd(a.2.mean))
df<-3
a.2.mean[i]<-mean(rchisq(2, df=df))
c(mean(a.2.mean), sd(a.2.mean))
df<-3
s <- sqrt(2 * df)
par(mfrow=c(2,2))
hist(a.2.mean, prob=T, ylab="", xlab="", main="표본 크기 : 2",
col="orange", border="red")
x1<-seq(min(a.2.mean), max(a.2.mean), length=1000)
y1<-dnorm(x=x1, mean=3, sd=s/sqrt(2)))
lines(x1, y1, lty=2, lwd=2, col='blue')
n<-1000
df<-3
s <- sqrt(2 * df)
a.2.mean<-rep(NA, n)
a.8.mean<-rep(NA, n)
a.32.mean<-rep(NA, n)
a.64.mean<-rep(NA, n)
for (i in 1:n){
a.2.mean[i]<-mean(rchisq(2, df=df))
a.8.mean[i]<-mean(rchisq(8, df=3))
a.32.mean[i]<-mean(rchisq(32, df=3))
a.64.mean[i]<-mean(rchisq(64, df=3))
}
options(digits=3)
c(mean(a.2.mean), sd(a.2.mean))
c(mean(a.8.mean), sd(a.8.mean))
c(mean(a.32.mean), sd(a.32.mean))
c(mean(a.64.mean), sd(a.64.mean))
par(mfrow=c(2,2))
hist(a.2.mean, prob=T, ylab="", xlab="", main="표본 크기 : 2",
col="orange", border="red")
x1<-seq(min(a.2.mean), max(a.2.mean), length=1000)
y1<-dnorm(x=x1, mean=3, sd=s/sqrt(2)))
lines(x1, y1, lty=2, lwd=2, col='blue')
x1<-seq(min(a.2.mean), max(a.2.mean), length=1000)
y1<-dnorm(x=x1, mean=3, sd=s/sqrt(2))
lines(x1, y1, lty=2, lwd=2, col='blue')
hist(a.8.mean, prob=T, ylab="", xlab="", main="표본 크기 : 8",
col="orange", border="red")
x2<-seq(min(a.8.mean), max(a.8.mean), length=1000)
y2<-dnorm( x=x2, mean=3, sd=s/sqrt(8))
lines(x2, y2, lty=2, lwd=2, col='blue')
hist(a.32.mean, prob=T, ylab="", xlab="", main="표본 크기 : 32",
col="orange", border="red")
x3<-seq(min(a.32.mean), max(a.32.mean), length=1000)
y3<-dnorm( x=x3, mean=3, sd=s/sqrt(32))
lines(x3, y3, lty=2, lwd=2, col='blue')
hist(a.64.mean, prob=T, ylab="", xlab="", main="표본 크기 : 64",
col="orange", border="red")
x4<-seq(min(a.64.mean), max(a.64.mean), length=1000)
y4<-dnorm( x=x4, mean=3, sd=s/sqrt(64))
lines(x4, y4, lty=2, lwd=2, col='blue')
t.2.mean<-rep(NA, n)
t.8.mean<-rep(NA, n)
t.32.mean<-rep(NA, n)
t.64.mean<-rep(NA, n)
for (i in 1:n){
t.2.mean[i]<-mean(rt(2, df=3))
t.8.mean[i]<-mean(rt(8, df=3))
t.32.mean[i]<-mean(rt(32, df=3))
t.64.mean[i]<-mean(rt(64, df=3))
}
options(digits=3)
c(mean(t.2.mean), sd(t.2.mean))
c(mean(t.8.mean), sd(t.8.mean))
c(mean(t.32.mean), sd(t.32.mean))
c(mean(t.64.mean), sd(t.64.mean))
par(mfrow=c(2,2))
hist(t.64.mean, prob=T, ylab="", xlab="", main="표본 크기 : 64",
col="orange", border="red")
x4<-seq(min(t.64.mean), max(t.64.mean), length=1000)
y4<-dnorm( x=x4, mean=3, sd=s/sqrt(64))
lines(x4, y4, lty=2, lwd=2, col='blue')
m<-df
s <- sqrt(2 * df)
setwd("D:/Workspace/R-statistics/ch07")
#모집단이 세 개 이상일 경우
ad <- read.csv("age.data.csv", header=T)
#모집단이 세 개 이상일 경우
setwd("D:/Workspace/R-statistics/ch07")
ad <- read.csv("age.data.csv", header=T)
ad$score <- ifelse(ad$score==99, NA, ad$score)
ad$scale <- factor(ad$scale)
ad$sex <- factor(ad$sex)
y1 <- ad$age[ad$scale=="1"]
y2 <- ad$age[ad$scale=="2"]
y3 <- ad$age[ad$scale=="3"]
y1.mean <- mean( y1 )
y2.mean <- mean( y2 )
y3.mean <- mean( y3 )
sse.1 <- sum( (y1 - y1.mean)^2 )
sse.2 <- sum( (y2 - y2.mean)^2 )
sse.3 <- sum( (y3 - y3.mean)^2 )
(sse <- sse.1 + sse.2 + sse.3)
(dfe <- (length(y1)-1) + (length(y2)-1) + (length(y3)-1))
y <- mean(ad$age)
sst.1 <- length(y1) * sum((y1.mean - y)^2)
sst.2 <- length(y2) * sum((y2.mean - y)^2)
sst.3 <- length(y3) * sum((y3.mean - y)^2)
(sst <- sst.1 + sst.2 + sst.3)
(dft <- length( levels( ad$scale ) ) - 1)
( tsq <- sum( (ad$age - y)^2 ) )
( ss <- sst + sse )
mst <- sst / dft
mse <- sse / dfe
(f.t <- mst / mse)
alpha <- 0.05
(tol <- qf(1-alpha, 2, 147))
(p.value <- 1 - pf(f.t, 2, 147))
# 그림 7-7
x <- seq(0, 4, by=0.01)
yf <- df(x, 2, 147)
par(mar=c(2, 1, 1, 1))
plot(x, yf, type="l", ylim=c(-0.1, 1), xlab="", ylab="", axes=F)
abline(h=0)
tol.r <- round(tol, 2)
polygon(c(tol.r, x[x>=tol.r], 4), c(0, yf[x>=tol.r], 0), col="red")
arrows(tol, 0.3, tol, 0.08, length=0.1)
text(tol, 0.32, paste("P(F(2, 147) > ", round(tol, 3),")=0.05", sep=""), cex=0.8)
lines(c(f.t, f.t), c(0,df(f.t, 2, 147)), lty=2)
arrows(f.t, -0.05, f.t, 0, length=0.05)
text(f.t, -0.1, paste("F(2, 147)=", round(f.t, 3),sep=""), cex=0.8)
ow <- lm(age~scale, data=ad)
anova(ow)
oneway.test(age~scale, data=ad, var.equal=TRUE)
str(ad)
ad$score <- ifelse(ad$score==99, NA, ad$score)
ad$scale <- factor(ad$scale)
ad$sex <- factor(ad$sex)
y1 <- ad$age[ad$scale=="1"]
y2 <- ad$age[ad$scale=="2"]
y3 <- ad$age[ad$scale=="3"]
y1.mean <- mean( y1 )
y2.mean <- mean( y2 )
y3.mean <- mean( y3 )
sse.1 <- sum( (y1 - y1.mean)^2 )
sse.2 <- sum( (y2 - y2.mean)^2 )
sse.3 <- sum( (y3 - y3.mean)^2 )
(sse <- sse.1 + sse.2 + sse.3)
(dfe <- (length(y1)-1) + (length(y2)-1) + (length(y3)-1))
(f.t <- mst / mse)
alpha <- 0.05
(tol <- qf(1-alpha, 2, 147))
(p.value <- 1 - pf(f.t, 2, 147))
#R을 이용한 p-value 구하기
ow <- lm(age~scale, data=ad)#lm은 leanear 모델
anova(ow)
#8장. 범주형 자료분석
#8-1. 적합도 검정
x <- seq(0, 15, by=0.01)
dc <- dchisq(x, df=3)
alpha <- 0.05
tol <- qchisq(0.95, df=3)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
#예제-1. 멘델의 법칙
x <- c(315, 101, 108, 32)
chisq.test(x, p=c(9, 3, 3, 1)/16)
polygon(c(t.t, x[x>t.t], 3), c(0, y[x>t.t], 0), density=20, angle=45)
text(t.t, -0.02, paste("t=", round(t.t, 3)), pos=4)
text(2.65, 0.1, expression(plain(P)(T>2.233) == 0.0196), cex=0.8)
arrows(2.7, 0.08, 2.5, 0.03, length=0.05)
#예제6-2. 단일 모비율 검정: 야구공의 불량률 검정(page239)
setwd('D:/Workspace/R-statistics/ch06')
# 도표 작성 : 그림 6-8
par(mar=c(0,1,1,1))
x <- seq(-3, 3, by=0.001)
y <- dt(x, df=n-1)
plot(x, y, type="l", axes=F, ylim=c(-0.02, 0.38), main="", xlab="t", ylab="")
abline(h=0)
polygon(c(c.u, x[x>c.u], 3), c(0, y[x>c.u], 0), col=2)
text(c.u, -0.02, expression(t[0.05]==1.74))
text(1.8, 0.2, expression(alpha == 0.05), cex=0.8)
arrows(1.8, 0.18, 1.8, 0.09, length=0.05)
polygon(c(t.t, x[x>t.t], 3), c(0, y[x>t.t], 0), density=20, angle=45)
text(t.t, -0.02, paste("t=", round(t.t, 3)), pos=4)
text(2.65, 0.1, expression(plain(P)(T>2.233) == 0.0196), cex=0.8)
arrows(2.7, 0.08, 2.5, 0.03, length=0.05)
#예제6-2. 단일 모비율 검정: 야구공의 불량률 검정(page239)
setwd('D:/Workspace/R-statistics/ch06')
tmp <- read.table("restitution.txt", header=T)
rel <- ifelse(tmp$rst < 0.4134 | tmp$rst > 0.4374, 1, 0)
# 도표 출력 : 그림 6-9
par(mar=c(0,1,1,1))
x <- seq(-3, 3, by=0.001)
y <- dnorm(x)
plot(x, y, type="l", axes=F, ylim=c(-0.02, 0.4), main="", xlab="z", ylab="")
abline(h=0)
polygon(c(c.u, x[x>c.u], 3), c(0, y[x>c.u], 0), col=2)
text(c.u, -0.02, expression(z[0.05]==1.645))
polygon(c(z, x[x>z], 3), c(0, y[x>z], 0), density=20, angle=45)
text(z, -0.02, paste("z=", round(z, 3)))
text(1.2, 0.3, paste("P(Z>z)=", round(p.value, 3)), cex=0.8)
#예제6-2. 단일 모비율 검정: 야구공의 불량률 검정(page239)
setwd('D:/Workspace/R-statistics/ch06')
tmp <- read.table("restitution.txt", header=T)
rel <- ifelse(tmp$rst < 0.4134 | tmp$rst > 0.4374, 1, 0)
n <- length(rel)
nos <- sum(rel)
sp <- nos / n
hp <- 0.1
(z <- (sp - hp) / sqrt( ( hp*(1-hp) )/n ) )
alpha <- 0.05
( c.u <- qnorm(1-alpha) )
( p.value <- 1 - pnorm(z) )
#1-sample proportions test without continuity correction
prop.test(nos, n, p=0.1, alternative="greater", correct=FALSE)
# 도표 출력 : 그림 6-9
par(mar=c(0,1,1,1))
x <- seq(-3, 3, by=0.001)
y <- dnorm(x)
plot(x, y, type="l", axes=F, ylim=c(-0.02, 0.4), main="", xlab="z", ylab="")
abline(h=0)
polygon(c(c.u, x[x>c.u], 3), c(0, y[x>c.u], 0), col=2)
text(c.u, -0.02, expression(z[0.05]==1.645))
polygon(c(z, x[x>z], 3), c(0, y[x>z], 0), density=20, angle=45)
text(z, -0.02, paste("z=", round(z, 3)))
text(1.2, 0.3, paste("P(Z>z)=", round(p.value, 3)), cex=0.8)
#예제-1. 멘델의 법칙
x <- c(315, 101, 108, 32)
chisq.test(x, p=c(9, 3, 3, 1)/16)
polygon(0.47, density=20, angle=45)
#8장. 범주형 자료분석
#8-1. 적합도 검정
x <- seq(0, 15, by=0.01)
dc <- dchisq(x, df=3)
alpha <- 0.05
tol <- qchisq(0.95, df=3)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
polygon(0.47, density=20, angle=45)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
#예제-1. 멘델의 법칙
x <- c(315, 101, 108, 32)
chisq.test(x, p=c(9, 3, 3, 1)/16)
polygon(c(0.47, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), density=20, angle=45)
polygon(c(tol.g, x[x>tol.g], 0.47), c(0, dc[x>tol.g], 0), density=20, angle=45)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), density=20, angle=45)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
#8장. 범주형 자료분석
#8-1. 적합도 검정
x <- seq(0, 15, by=0.01)
dc <- dchisq(x, df=3)
alpha <- 0.05
tol <- qchisq(0.95, df=3)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), density=20, angle=45)
#예제-1. 멘델의 법칙
x <- c(315, 101, 108, 32)
chisq.test(x, p=c(9, 3, 3, 1)/16)
polygon(c(tol.g, x[x>tol.g], 0.47), c(0, dc[x>tol.g], 0), density=20, angle=45)
polygon(c(tol.g, x[x>tol.g], 16), c(0, dc[x>tol.g], 0), density=20, angle=45)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), density=20, angle=45)
x <- seq(0, 15, by=0.01)
dc <- dchisq(x, df=3)
alpha <- 0.05
tol <- qchisq(0.95, df=3)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), density=20, angle=45)
x <- seq(0, 15, by=0.01)
dc <- dchisq(x, df=3)
alpha <- 0.05
tol <- qchisq(0.95, df=3)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
polygon(c(tol.g, x[x>tol.g], 0.47), c(0, dc[x>tol.g], 0), density=20, angle=45)
x <- seq(0, 15, by=0.01)
dc <- dchisq(x, df=3)
alpha <- 0.05
tol <- qchisq(0.95, df=3)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
polygon(c(tol.g, x[x>tol.g], 0.47), c(0, dc[x>tol.g], 0.25), density=20, angle=45)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
polygon(c(tol.g, x[x<tol.g], 0.47), c(0, dc[x>tol.g], 0.25), density=20, angle=45)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
polygon(c(tol.g, x[x<0.47], 15), c(0, dc[x>tol.g], 0), density=15, angle=45)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
polygon(c(tol.g, x[x<0.47], 15), c(0, dc[x>0.25], 0), density=15, angle=45)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
polygon(c(tol.g, x[x>0.47], 15), c(0, dc[x>0.25], 0), density=15, angle=45)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
polygon(c(tol.g, x[x>0.47], 15), c(0, dc[x>tol.g], 0), density=15, angle=45)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
polygon(c(tol.g, x[x>0.47], 15), c(0, dc[x>tol.g], 0), density=15, angle=45)
x <- seq(0, 15, by=0.01)
dc <- dchisq(x, df=3)
alpha <- 0.05
tol <- qchisq(0.95, df=3)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
polygon(c(tol.g, x[x>0.47], 15), c(0, dc[x>tol.g], 0), density=15, angle=45)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), density=15, angle=45)
#예제-1. 멘델의 법칙
x <- c(315, 101, 108, 32)
chisq.test(x, p=c(9, 3, 3, 1)/16)
tol2<-qchisq(1-0.9254, df=3)
tol2.g<-reoung(tol2, 2)
tol2<-qchisq(1-0.9254, df=3)
tol2.g<-round(tol2, 2)
polygon(c(tol2.g, x[x>tol2.g], 15), c(0, dc[x>tol2.g], 0), density=15, angle=45)
alpha <- 0.05
tol <- qchisq(0.95, df=3)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
tol2<-qchisq(1-0.9254, df=3)
tol2.g<-round(tol2, 2)
polygon(c(tol2.g, x[x>tol2.g], 15), c(0, dc[x>tol2.g], 0), col='blue', density=15, angle=45)
text(0, -0.01, '0', cex=0.8)
x <- seq(0, 15, by=0.01)
dc <- dchisq(x, df=3)
alpha <- 0.05
tol <- qchisq(0.95, df=3)
par(mar=c(0,1,1,1))
plot(x, dc, type="l", axes=F, ylim=c(-0.03, 0.25), xlab="", ylab="")
abline(h=0)
tol.g <- round(tol, 2)
polygon(c(tol.g, x[x>tol.g], 15), c(0, dc[x>tol.g], 0), col="red")
text(0, -0.03, "0", cex=0.8)
text(tol, -0.03, expression(chi[0.05]^{2}==2.14), cex=0.8)
tol2<-qchisq(1-0.9254, df=3)
tol2.g<-round(tol2, 2)
polygon(c(tol2.g, x[x>tol2.g], 15), c(0, dc[x>tol2.g], 0), col='blue', density=15, angle=45)
text(0, -0.01, '0', cex=0.8)
setwd("D:/Workspace/R-statistics/ch08")
sns.c <- read.csv("snsbyage.csv", header=T, stringsAsFactors=FALSE)
str( sns.c )
sns.c <- transform(sns.c, age.c =
factor(age, levels=c(1, 2, 3),
labels=c("20대", "30대", "40대")))
sns.c <- transform(sns.c, age.c = factor(age, levels=c(1, 2, 3), labels=c("20대", "30대", "40대")))
sns.c <- transform(sns.c, service.c = factor(service, levels=c("F", "T", "K", "C", "E"), ordered=TRUE))
c.tab <- table(sns.c$age.c, sns.c$service.c)
(a.n <- margin.table(c.tab, margin=1))
(s.n <- margin.table(c.tab, margin=2))
(s.p <- s.n / margin.table(c.tab))
(expected <- a.n %*% t(s.p))
(o.e <- c.tab-expected)
(t.t <- sum(  (o.e)^2 / expected ))
qchisq(0.95, df=8)
1-pchisq(t.t, df=8)
(a.n <- margin.table(c.tab, margin=1))
(t.t <- sum(  (o.e)^2 / expected ))
(o.e <- c.tab-expected)
qchisq(0.95, df=8)
1-pchisq(t.t, df=8)
chisq.test(c.tab)
names(result)
result<-chisq.test(c.tab)
names(result)
str(result)
result$p.value
addmargins(chisq.test(c.tab)$expected)
#예제-3. 성별에 따른 대학원 입학 여부의 독립성 검정
data(UCBAdmissions)
UCBAdmissions
ucba.tab <- apply(UCBAdmissions, c(1, 2), sum)
round(prop.table(ucba.tab, margin=2) * 100, 1)
# 독립성 검정
(a.n <- margin.table(ucba.tab, margin=1))
(g.n <- margin.table(ucba.tab, margin=2))
(a.p <- a.n / margin.table(ucba.tab))
(g.p <- g.n / margin.table(ucba.tab))
(expected <- margin.table(ucba.tab) * (a.p %*% t(g.p)))
addmargins( expected )
## chi-square statistic
o.e <- (ucba.tab - expected)^2 / expected
addmargins(o.e)
chisq.t <- sum(o.e)
chisq.t
qchisq(0.95, df=1)
1-pchisq(112.250, df=1)
1-pchisq(chisq.t, df=1)
chisq.test(ucba.tab)
## continuity correction
o.e2 <- (abs(ucba.tab - expected)-0.5)^2 / expected
sum(o.e2)
chisq.test(ucba.tab, correct=FALSE)
ucba.tab <- apply(UCBAdmissions, c(1, 2), sum)
#예제-3. 성별에 따른 대학원 입학 여부의 독립성 검정
data(UCBAdmissions)
UCBAdmissions
ucba.tab <- apply(UCBAdmissions, c(1, 2), sum)
round(prop.table(ucba.tab, margin=2) * 100, 1)#
ucba.tab
# 독립성 검정
(a.n <- margin.table(ucba.tab, margin=1))
(g.n <- margin.table(ucba.tab, margin=2))
(a.p <- a.n / margin.table(ucba.tab))
(g.p <- g.n / margin.table(ucba.tab))
(expected <- margin.table(ucba.tab) * (a.p %*% t(g.p)))
addmargins( expected )
## chi-square statistic
o.e <- (ucba.tab - expected)^2 / expected
addmargins(o.e)
chisq.t <- sum(o.e)
chisq.t
qchisq(0.95, df=1)
1-pchisq(112.250, df=1)
1-pchisq(chisq.t, df=1)
chisq.test(ucba.tab)
## continuity correction
o.e2 <- (abs(ucba.tab - expected)-0.5)^2 / expected
sum(o.e2)
chisq.test(ucba.tab, correct=FALSE)
## continuity correction
o.e2 <- (abs(ucba.tab - expected)-0.5)^2 / expected
sum(o.e2)
chisq.test(ucba.tab, correct=FALSE)
